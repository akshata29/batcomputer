{"source":2,"revision":50,"description":null,"createdBy":{"displayName":"Ben Coleman","url":"https://spsprodweu3.vssps.visualstudio.com/A40a38c72-9e96-4ee0-9057-3eb12507fbbd/_apis/Identities/81613f75-f6e3-49cb-abdf-ff2ba28a0d03","_links":{"avatar":{"href":"https://dev.azure.com/bencoleman/_apis/GraphProfile/MemberAvatars/aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"}},"id":"81613f75-f6e3-49cb-abdf-ff2ba28a0d03","uniqueName":"becolem@microsoft.com","imageUrl":"https://dev.azure.com/bencoleman/_api/_common/identityImage?id=81613f75-f6e3-49cb-abdf-ff2ba28a0d03","descriptor":"aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"},"createdOn":"2018-11-04T09:29:52.287Z","modifiedBy":{"displayName":"Ben Coleman","url":"https://spsprodweu3.vssps.visualstudio.com/A40a38c72-9e96-4ee0-9057-3eb12507fbbd/_apis/Identities/81613f75-f6e3-49cb-abdf-ff2ba28a0d03","_links":{"avatar":{"href":"https://dev.azure.com/bencoleman/_apis/GraphProfile/MemberAvatars/aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"}},"id":"81613f75-f6e3-49cb-abdf-ff2ba28a0d03","uniqueName":"becolem@microsoft.com","imageUrl":"https://dev.azure.com/bencoleman/_api/_common/identityImage?id=81613f75-f6e3-49cb-abdf-ff2ba28a0d03","descriptor":"aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"},"modifiedOn":"2019-03-06T12:33:04.283Z","isDeleted":false,"variables":{"API_HOST":{"value":"$(PREFIX)-$(Release.EnvironmentName)-$(Release.Artifacts.acr-image.BuildNumber).$(AZURE_REGION).azurecontainer.io:8000"},"AZURE_RESGRP":{"value":"temp.batcomputer"},"PREFIX":{"value":"batcomputer"}},"variableGroups":[5],"environments":[{"id":1,"name":"test","rank":1,"owner":{"displayName":"Ben Coleman","url":"https://spsprodweu3.vssps.visualstudio.com/A40a38c72-9e96-4ee0-9057-3eb12507fbbd/_apis/Identities/81613f75-f6e3-49cb-abdf-ff2ba28a0d03","_links":{"avatar":{"href":"https://dev.azure.com/bencoleman/_apis/GraphProfile/MemberAvatars/aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"}},"id":"81613f75-f6e3-49cb-abdf-ff2ba28a0d03","uniqueName":"becolem@microsoft.com","imageUrl":"https://dev.azure.com/bencoleman/_api/_common/identityImage?id=81613f75-f6e3-49cb-abdf-ff2ba28a0d03","descriptor":"aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":1}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":2},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":3}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":51,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Deploy Phase","refName":null,"workflowTasks":[{"environment":{},"taskId":"94a74903-f93f-4075-884f-dc11f34058b4","version":"2.*","name":"Deploy ACI with ARM","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectedServiceName":"535c0bca-5784-48ad-a92b-beaac0f45237","action":"Create Or Update Resource Group","resourceGroupName":"$(AZURE_RESGRP)","location":"$(AZURE_REGION)","templateLocation":"Linked artifact","csmFileLink":"","csmParametersFileLink":"","csmFile":"$(System.DefaultWorkingDirectory)/batcomputer-src/azure/aci-arm-template/azuredeploy.json","csmParametersFile":"$(System.DefaultWorkingDirectory)/batcomputer-src/azure/aci-arm-template/azuredeploy.parameters.json","overrideParameters":"-acrName $(ACR_NAME) -acrPassword $(ACR_PASSWORD) -modelVersion $(Release.Artifacts.acr-image.BuildNumber) -imageName $(Release.Artifacts.acr-image.DefinitionName) -containerName $(PREFIX)-$(Release.EnvironmentName)","deploymentMode":"Incremental","enableDeploymentPrerequisites":"None","deploymentGroupEndpoint":"","project":"","deploymentGroupName":"","copyAzureVMTags":"true","runAgentServiceAsUser":"false","userName":"","password":"","outputVariable":"","deploymentName":"","deploymentOutputs":"","addSpnToEnvironment":"false"}}]},{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":2,"phaseType":2,"name":"Delay Phase","refName":null,"workflowTasks":[{"environment":{},"taskId":"28782b92-5e8e-4458-9751-a71cd1492bae","version":"1.*","name":"Delay by 1 minutes","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"delayForMinutes":"1"}}]},{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[{"alias":"acr-image","artifactType":"AzureContainerRepository","artifactDownloadMode":"Skip"},{"alias":"batcomputer-src","artifactType":"GitHub","artifactDownloadMode":"All"}]},"queueId":51,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":3,"phaseType":1,"name":"Test Phase","refName":null,"workflowTasks":[{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Install Newman","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"npm install -g newman --prefix $(System.DefaultWorkingDirectory) ","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Run Tests","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"cd batcomputer-src\n\n$(System.DefaultWorkingDirectory)/bin/newman run ./tests/Batcomputer.postman_collection.json -r junit --timeout 60000 --reporter-junit-export test-results.xml --global-var api-host=\"$(API_HOST)\"\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"0b0f01ed-7dde-43ff-9cbb-e48954daf9b1","version":"2.*","name":"Publish Test Results","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"testRunner":"JUnit","testResultsFiles":"test-results.xml","searchFolder":"$(System.DefaultWorkingDirectory)/batcomputer-src/","mergeTestResults":"false","failTaskOnFailedTests":"false","testRunTitle":"","platform":"","configuration":"","publishRunAttachments":"true"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":107,"url":"https://vsrm.dev.azure.com/bencoleman/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/_apis/Release/releases/107","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/bencoleman/_apis/public/Release/badge/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/1/1"},{"id":7,"name":"staging","rank":2,"owner":{"displayName":"Ben Coleman","url":"https://spsprodweu3.vssps.visualstudio.com/A40a38c72-9e96-4ee0-9057-3eb12507fbbd/_apis/Identities/81613f75-f6e3-49cb-abdf-ff2ba28a0d03","_links":{"avatar":{"href":"https://dev.azure.com/bencoleman/_apis/GraphProfile/MemberAvatars/aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"}},"id":"81613f75-f6e3-49cb-abdf-ff2ba28a0d03","uniqueName":"becolem@microsoft.com","imageUrl":"https://dev.azure.com/bencoleman/_api/_common/identityImage?id=81613f75-f6e3-49cb-abdf-ff2ba28a0d03","descriptor":"aad.YjMxYTRlM2UtY2YwZi03YWJjLTkzMTgtOWZkOGQ1OTg2N2Ez"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":19}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":20},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":21}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":51,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Deploy Phase","refName":null,"workflowTasks":[{"environment":{},"taskId":"94a74903-f93f-4075-884f-dc11f34058b4","version":"2.*","name":"Deploy ACI with ARM","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectedServiceName":"535c0bca-5784-48ad-a92b-beaac0f45237","action":"Create Or Update Resource Group","resourceGroupName":"$(AZURE_RESGRP)","location":"$(AZURE_REGION)","templateLocation":"Linked artifact","csmFileLink":"","csmParametersFileLink":"","csmFile":"$(System.DefaultWorkingDirectory)/batcomputer-src/azure/aci-arm-template/azuredeploy.json","csmParametersFile":"$(System.DefaultWorkingDirectory)/batcomputer-src/azure/aci-arm-template/azuredeploy.parameters.json","overrideParameters":"-acrName $(ACR_NAME) -acrPassword $(ACR_PASSWORD) -modelVersion $(Release.Artifacts.acr-image.BuildNumber) -imageName $(Release.Artifacts.acr-image.DefinitionName) -containerName $(PREFIX)-$(Release.EnvironmentName)","deploymentMode":"Incremental","enableDeploymentPrerequisites":"None","deploymentGroupEndpoint":"","project":"","deploymentGroupName":"","copyAzureVMTags":"true","runAgentServiceAsUser":"false","userName":"","password":"","outputVariable":"","deploymentName":"","deploymentOutputs":"","addSpnToEnvironment":"false"}}]},{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":2,"phaseType":2,"name":"Delay Phase","refName":null,"workflowTasks":[{"environment":{},"taskId":"28782b92-5e8e-4458-9751-a71cd1492bae","version":"1.*","name":"Delay by 1 minutes","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"delayForMinutes":"1"}}]},{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[{"alias":"acr-image","artifactType":"AzureContainerRepository","artifactDownloadMode":"Skip"},{"alias":"batcomputer-src","artifactType":"GitHub","artifactDownloadMode":"All"}]},"queueId":51,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":3,"phaseType":1,"name":"Test Phase","refName":null,"workflowTasks":[{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Install Newman","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"npm install -g newman --prefix $(System.DefaultWorkingDirectory) ","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"6c731c3c-3c68-459a-a5c9-bde6e6595b5b","version":"3.*","name":"Run Tests","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"targetType":"inline","filePath":"","arguments":"","script":"cd batcomputer-src\n\n$(System.DefaultWorkingDirectory)/bin/newman run ./tests/Batcomputer.postman_collection.json -r junit --timeout 60000 --reporter-junit-export test-results.xml --global-var api-host=\"$(API_HOST)\"\n","workingDirectory":"","failOnStderr":"false","noProfile":"true","noRc":"true"}},{"environment":{},"taskId":"0b0f01ed-7dde-43ff-9cbb-e48954daf9b1","version":"2.*","name":"Publish Test Results","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"testRunner":"JUnit","testResultsFiles":"test-results.xml","searchFolder":"$(System.DefaultWorkingDirectory)/batcomputer-src/","mergeTestResults":"false","failTaskOnFailedTests":"false","testRunTitle":"","platform":"","configuration":"","publishRunAttachments":"true"}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"test","conditionType":2,"value":"4"}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":107,"url":"https://vsrm.dev.azure.com/bencoleman/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/_apis/Release/releases/107","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/bencoleman/_apis/public/Release/badge/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/1/7"}],"artifacts":[{"sourceId":"535c0bca-5784-48ad-a92b-beaac0f45237:bencmldemo3408602738.azurecr.io:batcomputer-model-api","type":"AzureContainerRepository","alias":"acr-image","definitionReference":{"connection":{"id":"535c0bca-5784-48ad-a92b-beaac0f45237","name":"Microsoft (AIRS) (52512f28-c6ed-403e-9569-82a9fb9fec91)"},"defaultVersionType":{"id":"latestType","name":"Latest"},"definition":{"id":"batcomputer-model-api","name":"batcomputer-model-api"},"registryurl":{"id":"bencmldemo3408602738.azurecr.io","name":"bencmldemo3408602738"},"resourcegroup":{"id":"Demo.AzureML","name":"Demo.AzureML"}},"isRetained":false},{"sourceId":"1f362326-cbb0-4ee5-947f-120a3484b3e3:benc-uk/batcomputer","type":"GitHub","alias":"batcomputer-src","definitionReference":{"artifactSourceDefinitionUrl":{"id":"https://github.com/benc-uk/batcomputer","name":""},"branch":{"id":"master","name":"master"},"checkoutNestedSubmodules":{"id":"True","name":"Any nested submodules within"},"checkoutSubmodules":{"id":"","name":""},"connection":{"id":"1f362326-cbb0-4ee5-947f-120a3484b3e3","name":"GitHub connection benc-uk"},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionType":{"id":"latestFromBranchType","name":"Latest from the default branch"},"definition":{"id":"benc-uk/batcomputer","name":"benc-uk/batcomputer"},"fetchDepth":{"id":"","name":""},"gitLfsSupport":{"id":"","name":""}},"isPrimary":true,"isRetained":false}],"triggers":[{"alias":"acr-image","tagFilters":[],"triggerType":4}],"releaseNameFormat":"Release-$(rev:r)","tags":[],"pipelineProcess":{"type":1},"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"Other"}},"id":1,"name":"Deploy Batcomputer to ACI","path":"\\","projectReference":null,"url":"https://vsrm.dev.azure.com/bencoleman/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/_apis/Release/definitions/1","_links":{"self":{"href":"https://vsrm.dev.azure.com/bencoleman/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/_apis/Release/definitions/1"},"web":{"href":"https://dev.azure.com/bencoleman/0e6c25b9-ab70-4701-8460-2468c8ea9b3a/_release?definitionId=1"}}}